<div *ngIf="!clientes">
  <h2>Cargando...</h2>
</div>

<div
  *ngIf="clientes"
  class="example-container mat-elevation-z8 mt-3 animate__animated animate__fadeIn"
>
  <mat-toolbar>
    <div class="filter">
      <mat-form-field appearance="standard">
        <mat-label>Filtro</mat-label>
        <input
          matInput
          (keyup)="applyFilter($event)"
          placeholder="Ejemplo. Juan"
          #input
          autocomplete="off"
        />
      </mat-form-field>
    </div>

    <span class="example-spacer"></span>

    <button mat-raised-button color="warn" (click)="crearCliente()">
      Agregar Cliente
    </button>
  </mat-toolbar>
  <div class="example-table-container table-responsive-md">
    <table
      class="table table-sm table-bordered"
      mat-table
      [dataSource]="dataSource"
      matSort
    >
      <!-- tipo_doc Column -->
      <ng-container matColumnDef="tipo_doc">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          TIPO DOC
        </th>
        <td class="col-lg-1" mat-cell *matCellDef="let row">
          {{ row.tipo_doc }}
        </td>
      </ng-container>

      <!-- num_doc_usr Column -->
      <ng-container matColumnDef="num_doc_usr">
        <th
          class="table-dark col-lg-1 mx-auto"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          DOCUMENTO
        </th>
        <td mat-cell *matCellDef="let row">{{ row.num_doc_usr }}</td>
      </ng-container>

      <!-- apellido1 Column -->
      <ng-container matColumnDef="apellido1">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          PRIMER APELLIDO
        </th>
        <td mat-cell *matCellDef="let row">{{ row.apellido1 }}</td>
      </ng-container>
      <!-- apellido2 Column -->
      <ng-container matColumnDef="apellido2">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          SEGUNDO APELLIDO
        </th>
        <td mat-cell *matCellDef="let row">{{ row.apellido2 }}</td>
      </ng-container>
      <!-- nombre1 Column -->
      <ng-container matColumnDef="nombre1">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          PRIMER NOMBRE
        </th>
        <td mat-cell *matCellDef="let row">{{ row.nombre1 }}</td>
      </ng-container>
      <!-- nombre2 Column -->
      <ng-container matColumnDef="nombre2">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          SEGUNDO NOMBRE
        </th>
        <td mat-cell *matCellDef="let row">{{ row.nombre2 }}</td>
      </ng-container>
      <!-- celular Column -->
      <ng-container matColumnDef="celular">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          CELULAR
        </th>
        <td mat-cell *matCellDef="let row">{{ row.celular }}</td>
      </ng-container>
      <!-- estado Column -->
      <ng-container matColumnDef="estado">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          ESTADO
        </th>
        <td mat-cell *matCellDef="let row">
          <span
            class="badge estado"
            [ngClass]="{
              'bg-primary': row.estado == 'PENDIENTE',
              'bg-success': row.estado == 'CONFIRMADO',
              'bg-danger': row.estado == 'ERROR'
            }"
            >{{ row.estado }}</span
          >
        </td>
      </ng-container>
      <!-- fecha_proceso Column -->
      <ng-container matColumnDef="created_at">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          FECHA CREACION
        </th>
        <td mat-cell *matCellDef="let row">
          {{ row.created_at | date: "dd-MM-yyyy, h:mm a" }}
        </td>
      </ng-container>
      <!-- fecha_proceso Column -->
      <ng-container matColumnDef="update_at">
        <th
          class="table-dark col-lg-1"
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
        >
          FECHA ACTUALIZACION
        </th>
        <td mat-cell *matCellDef="let row">
          {{ row.update_at | date: "dd-MM-yyyy, h:mm a" }}
        </td>
      </ng-container>

      <!-- acciones Column -->
      <ng-container matColumnDef="acciones">
        <th class="table-dark col-lg-1" mat-header-cell *matHeaderCellDef>
          ACCIONES
        </th>
        <td mat-cell *matCellDef="let row">
          <button
            mat-icon-button
            color="primary"
            matTooltip="Editar"
            (click)="editarCliente(row)"
          >
            <mat-icon>edit</mat-icon>
          </button>
          <button
            mat-icon-button
            color="warn"
            matTooltip="Eliminar"
            (click)="borrarCliente(row)"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns; let i = index"
        (click)="selectRow(row)"
        (click)="selectedRow = selectedRow === row ? null : row"
        [class.demo-row-is-clicked]="selectedRow === row"
        (dblclick)="editarCliente(row)"
      ></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell noResultados" colspan="4">
          No hay resultados para "{{ input.value }}"
        </td>
      </tr>
    </table>
  </div>
  <mat-paginator
    [pageSize]="10"
    [pageSizeOptions]="[5, 10, 25, 100]"
    showFirstLastButtons
  ></mat-paginator>
</div>
